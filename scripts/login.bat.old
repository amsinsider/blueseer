@echo off

set mypath=%cd%
set j9="0"

cd %~dp0


if exist "%PROGRAMFILES(X86)%" (set bit="x64") else (set bit="x86")

for /f tokens^=2-5^ delims^=.-_^" %%j in ('java -fullversion 2^>^&1') do set "jver=%%j%%k%%l%%m"


if "%jver%" gtr "189999" (
set j9="1"
)

if "%jver%" gtr "169999" (
echo "Java version is sufficient"
echo "%jver%"
) else (
echo "Java version is insufficient"
goto :nojava
)


for /f tokens^=2^ delims^=^" %%i in ('reg query HKEY_CLASSES_ROOT\jarfile\shell\open\command /ve') do set JAVAW_PATH=%%i


::if reg entry is not found, java is not installed
if "%JAVAW_PATH%"=="" (
Echo "Java is not installed...will use jre in app"
goto :nojava
) else (
     if %j9%=="1" (
     goto :startappJava9
     ) else (
     goto :startapp
     )
)

:nojava
     if exist "%mypath%\java86" (
       echo "using java86 JRE provided with App"
       set "PATH=java86\jre\bin;%PATH%"
       goto :startapp
     ) else (
       echo "java86 directory not available" 
     )
  goto :EOF


:startapp
 echo "%j9%"
 start javaw -cp "dist\*" bsmf.MainFrame
 goto :EOF

:startappJava9
 echo "running java 9"
 start javaw --add-modules java.activation -cp "dist\*" bsmf.MainFrame
 goto :EOF



goto :EOF








